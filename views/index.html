<% /*! @license Â©2013 Ruben Verborgh - Multimedia Lab / iMinds / Ghent University */ -%>
<% inherits('base') %>

<% var hasQuery = Object.keys(query).length === 0; %>
<% if (hasQuery) { %>
  <h2>Data sources</h2>
  <p>This Linked Data Fragments server offers the following datasets:</p>
  <% queryResult -> result -%>
  <%
    var dataSources = [];
    result.triples.forEach(function (triple) {
      if(triple.predicate === 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type' &&
         triple.object === 'http://rdfs.org/ns/void#Dataset') {
         dataSources.push({ url: triple.subject,
                            name: triple.subject.match(/[\-a-z_]+$/i)[0] });
      }
    });
  %>
  <ul>
    <% dataSources.forEach(function (dataSource) { %>
      <li><a href="<%= dataSource.url %>"><%= dataSource.name %></a></li>
    <% }) %>
  </ul>
  <% <- -%>
  <hr>
<% } %>

<%- render('fragment') %>
